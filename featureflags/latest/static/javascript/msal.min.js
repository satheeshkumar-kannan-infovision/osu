/*! For license information please see msal.min.js.LICENSE.txt */
"use strict";!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("Msal",[],t):"object"==typeof exports?exports.Msal=t():e.Msal=t()}(window,(function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=17)}([function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(2),i=r(4),s=r(2),a=function(){function e(){}return e.compareAccounts=function(e,t){return!!(e&&t&&e.homeAccountIdentifier&&t.homeAccountIdentifier&&e.homeAccountIdentifier===t.homeAccountIdentifier)},e.decimalToHex=function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t},e.getLibraryVersion=function(){return s.Library.version},e.createNewGuid=function(){var t=window.crypto;if(t&&t.getRandomValues){var r=new Uint8Array(16);return t.getRandomValues(r),r[6]|=64,r[6]&=79,r[8]|=128,r[8]&=191,e.decimalToHex(r[0])+e.decimalToHex(r[1])+e.decimalToHex(r[2])+e.decimalToHex(r[3])+"-"+e.decimalToHex(r[4])+e.decimalToHex(r[5])+"-"+e.decimalToHex(r[6])+e.decimalToHex(r[7])+"-"+e.decimalToHex(r[8])+e.decimalToHex(r[9])+"-"+e.decimalToHex(r[10])+e.decimalToHex(r[11])+e.decimalToHex(r[12])+e.decimalToHex(r[13])+e.decimalToHex(r[14])+e.decimalToHex(r[15])}for(var n="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",o="0123456789abcdef",i=0,s="",a=0;a<36;a++)"-"!==n[a]&&"4"!==n[a]&&(i=16*Math.random()|0),"x"===n[a]?s+=o[i]:"y"===n[a]?(i&=3,s+=o[i|=8]):s+=n[a];return s},e.expiresIn=function(e){return e||(e="3599"),this.now()+parseInt(e,10)},e.now=function(){return Math.round((new Date).getTime()/1e3)},e.isEmpty=function(e){return void 0===e||!e||0===e.length},e.decodeJwt=function(e){if(this.isEmpty(e))return null;var t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);return!t||t.length<4?null:{header:t[1],JWSPayload:t[2],JWSSig:t[3]}},e.extractIdToken=function(e){var t=this.decodeJwt(e);if(!t)return null;try{var r=t.JWSPayload,n=this.base64DecodeStringUrlSafe(r);return n?JSON.parse(n):null}catch(e){}return null},e.base64EncodeStringUrlSafe=function(e){return window.btoa?window.btoa(e):this.encode(e)},e.base64DecodeStringUrlSafe=function(e){return e=e.replace(/-/g,"+").replace(/_/g,"/"),window.atob?decodeURIComponent(encodeURIComponent(window.atob(e))):decodeURIComponent(encodeURIComponent(this.decode(e)))},e.encode=function(e){var t,r,n,o,i,s,a,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",u="",l=0;for(e=this.utf8Encode(e);l<e.length;)o=(t=e.charCodeAt(l++))>>2,i=(3&t)<<4|(r=e.charCodeAt(l++))>>4,s=(15&r)<<2|(n=e.charCodeAt(l++))>>6,a=63&n,isNaN(r)?s=a=64:isNaN(n)&&(a=64),u=u+c.charAt(o)+c.charAt(i)+c.charAt(s)+c.charAt(a);return u.replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")},e.utf8Encode=function(e){e=e.replace(/\r\n/g,"\n");for(var t="",r=0;r<e.length;r++){var n=e.charCodeAt(r);n<128?t+=String.fromCharCode(n):(127<n&&n<2048?t+=String.fromCharCode(n>>6|192):(t+=String.fromCharCode(n>>12|224),t+=String.fromCharCode(n>>6&63|128)),t+=String.fromCharCode(63&n|128))}return t},e.decode=function(e){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",r=(e=String(e).replace(/=+$/,"")).length;if(r%4==1)throw i.ClientAuthError.createTokenEncodingError(e);for(var n,o,s,a,c,u,l,d,h="",p=0;p<r;p+=4){if(n=t.indexOf(e.charAt(p)),o=t.indexOf(e.charAt(p+1)),s=t.indexOf(e.charAt(p+2)),a=t.indexOf(e.charAt(p+3)),p+2===r-1){u=(c=n<<18|o<<12|s<<6)>>16&255,l=c>>8&255,h+=String.fromCharCode(u,l);break}if(p+1===r-1){u=(c=n<<18|o<<12)>>16&255,h+=String.fromCharCode(u);break}u=(c=n<<18|o<<12|s<<6|a)>>16&255,l=c>>8&255,d=255&c,h+=String.fromCharCode(u,l,d)}return h},e.deserialize=function(e){var t,r=/\+/g,n=/([^&=]+)=([^&]*)/g,o=function(e){return decodeURIComponent(e.replace(r," "))},i={};for(t=n.exec(e);t;)i[o(t[1])]=o(t[2]),t=n.exec(e);return i},e.isIntersectingScopes=function(e,t){e=this.convertToLowerCase(e);for(var r=0;r<t.length;r++)if(-1<e.indexOf(t[r].toLowerCase()))return!0;return!1},e.containsScope=function(e,t){return e=this.convertToLowerCase(e),t.every((function(t){return 0<=e.indexOf(t.toString().toLowerCase())}))},e.convertToLowerCase=function(e){return e.map((function(e){return e.toLowerCase()}))},e.removeElement=function(e,t){return e.filter((function(e){return e!==t}))},e.getDefaultRedirectUri=function(){return window.location.href.split("?")[0].split("#")[0]},e.replaceTenantPath=function(e,t){e=e.toLowerCase();var r=this.GetUrlComponents(e),n=r.PathSegments;return!t||0===n.length||n[0]!==o.Constants.common&&n[0]!==o.SSOTypes.ORGANIZATIONS||(n[0]=t),this.constructAuthorityUriFromObject(r,n)},e.constructAuthorityUriFromObject=function(e,t){return this.CanonicalizeUri(e.Protocol+"//"+e.HostNameAndPort+"/"+t.join("/"))},e.GetUrlComponents=function(e){if(!e)throw"Url required";var t=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),r=e.match(t);if(!r||r.length<6)throw"Valid url required";var n={Protocol:r[1],HostNameAndPort:r[4],AbsolutePath:r[5]},o=n.AbsolutePath.split("/");return o=o.filter((function(e){return e&&0<e.length})),n.PathSegments=o,n},e.CanonicalizeUri=function(t){return t&&(t=t.toLowerCase()),t&&!e.endsWith(t,"/")&&(t+="/"),t},e.endsWith=function(e,t){return!(!e||!t)&&-1!==e.indexOf(t,e.length-t.length)},e.urlRemoveQueryStringParameter=function(e,t){if(this.isEmpty(e))return e;var r=new RegExp("(\\&"+t+"=)[^&]+");return e=e.replace(r,""),r=new RegExp("("+t+"=)[^&]+&"),e=e.replace(r,""),r=new RegExp("("+t+"=)[^&]+"),e.replace(r,"")},e.constructUnifiedCacheQueryParameter=function(e,t){var r,n,i={};if(e)if(e.account){var s=e.account;s.sid?(r=o.SSOTypes.SID,n=s.sid):s.userName&&(r=o.SSOTypes.LOGIN_HINT,n=s.userName)}else e.sid?(r=o.SSOTypes.SID,n=e.sid):e.loginHint&&(r=o.SSOTypes.LOGIN_HINT,n=e.loginHint);else t&&(n=t.hasOwnProperty(o.Constants.upn)?(r=o.SSOTypes.ID_TOKEN,t.upn):(r=o.SSOTypes.ORGANIZATIONS,null));return i=this.addSSOParameter(r,n),e&&e.account&&e.account.homeAccountIdentifier&&(i=this.addSSOParameter(o.SSOTypes.HOMEACCOUNT_ID,e.account.homeAccountIdentifier,i)),i},e.addSSOParameter=function(t,r,n){if(n||(n={}),!r)return n;switch(t){case o.SSOTypes.SID:n[o.SSOTypes.SID]=r;break;case o.SSOTypes.ID_TOKEN:n[o.SSOTypes.LOGIN_HINT]=r,n[o.SSOTypes.DOMAIN_HINT]=o.SSOTypes.ORGANIZATIONS;break;case o.SSOTypes.LOGIN_HINT:n[o.SSOTypes.LOGIN_HINT]=r;break;case o.SSOTypes.ORGANIZATIONS:n[o.SSOTypes.DOMAIN_HINT]=o.SSOTypes.ORGANIZATIONS;break;case o.SSOTypes.CONSUMERS:n[o.SSOTypes.DOMAIN_HINT]=o.SSOTypes.CONSUMERS;break;case o.SSOTypes.HOMEACCOUNT_ID:var i=r.split("."),s=e.base64DecodeStringUrlSafe(i[0]),a=e.base64DecodeStringUrlSafe(i[1]);n[o.SSOTypes.LOGIN_REQ]=s,(n[o.SSOTypes.DOMAIN_REQ]=a)===o.Constants.consumersUtid?n[o.SSOTypes.DOMAIN_HINT]=o.SSOTypes.CONSUMERS:n[o.SSOTypes.DOMAIN_HINT]=o.SSOTypes.ORGANIZATIONS;break;case o.SSOTypes.LOGIN_REQ:n[o.SSOTypes.LOGIN_REQ]=r;break;case o.SSOTypes.DOMAIN_REQ:n[o.SSOTypes.DOMAIN_REQ]=r}return n},e.generateQueryParametersString=function(e){var t=null;return e&&Object.keys(e).forEach((function(r){null==t?t=r+"="+encodeURIComponent(e[r]):t+="&"+r+"="+encodeURIComponent(e[r])})),t},e.isSSOParam=function(e){return e&&(e.account||e.sid||e.loginHint)},e.setResponseIdToken=function(e,t){var r=n.__assign({},e);return r.idToken=t,r.idToken.objectId?r.uniqueId=r.idToken.objectId:r.uniqueId=r.idToken.subject,r.tenantId=r.idToken.tenantId,r},e}();t.Utils=a},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function o(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}}function i(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),s=[];try{for(;(void 0===t||0<t--)&&!(n=i.next()).done;)s.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s}function s(e){return this instanceof s?(this.v=e,this):new s(e)}t.__extends=function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},t.__assign=function(){return t.__assign=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},t.__assign.apply(this,arguments)},t.__rest=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&(r[n[o]]=e[n[o]])}return r},t.__decorate=function(e,t,r,n){var o,i=arguments.length,s=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;0<=a;a--)(o=e[a])&&(s=(i<3?o(s):3<i?o(t,r,s):o(t,r))||s);return 3<i&&s&&Object.defineProperty(t,r,s),s},t.__param=function(e,t){return function(r,n){t(r,n,e)}},t.__metadata=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},t.__awaiter=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){e.done?o(e.value):new r((function(t){t(e.value)})).then(s,a)}c((n=n.apply(e,t||[])).next())}))},t.__generator=function(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=0<(o=s.trys).length&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},t.__exportStar=function(e,t){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])},t.__values=o,t.__read=i,t.__spread=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(i(arguments[t]));return e},t.__await=s,t.__asyncGenerator=function(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(e,t||[]),i=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(e){o[e]&&(n[e]=function(t){return new Promise((function(r,n){1<i.push([e,t,r,n])||c(e,t)}))})}function c(e,t){try{(r=o[e](t)).value instanceof s?Promise.resolve(r.value.v).then(u,l):d(i[0][2],r)}catch(e){d(i[0][3],e)}var r}function u(e){c("next",e)}function l(e){c("throw",e)}function d(e,t){e(t),i.shift(),i.length&&c(i[0][0],i[0][1])}},t.__asyncDelegator=function(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,o){t[n]=e[n]?function(t){return(r=!r)?{value:s(e[n](t)),done:"return"===n}:o?o(t):t}:o}},t.__asyncValues=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=o(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,o){var i,s,a,c;t=e[r](t),i=n,s=o,a=t.done,c=t.value,Promise.resolve(c).then((function(e){i({value:e,done:a})}),s)}))}}},t.__makeTemplateObject=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},t.__importStar=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t},t.__importDefault=function(e){return e&&e.__esModule?e:{default:e}}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return Object.defineProperty(e,"errorDescription",{get:function(){return"error_description"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"error",{get:function(){return"error"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"scope",{get:function(){return"scope"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"clientInfo",{get:function(){return"client_info"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"clientId",{get:function(){return"clientId"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"idToken",{get:function(){return"id_token"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"adalIdToken",{get:function(){return"adal.idtoken"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"accessToken",{get:function(){return"access_token"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"expiresIn",{get:function(){return"expires_in"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"sessionState",{get:function(){return"session_state"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"claims",{get:function(){return"claims"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"msalClientInfo",{get:function(){return"msal.client.info"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"msalError",{get:function(){return"msal.error"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"msalErrorDescription",{get:function(){return"msal.error.description"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"msalSessionState",{get:function(){return"msal.session.state"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"tokenKeys",{get:function(){return"msal.token.keys"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"accessTokenKey",{get:function(){return"msal.access.token.key"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"expirationKey",{get:function(){return"msal.expiration.key"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"stateLogin",{get:function(){return"msal.state.login"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"stateAcquireToken",{get:function(){return"msal.state.acquireToken"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"stateRenew",{get:function(){return"msal.state.renew"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"nonceIdToken",{get:function(){return"msal.nonce.idtoken"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"userName",{get:function(){return"msal.username"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"idTokenKey",{get:function(){return"msal.idtoken"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"loginRequest",{get:function(){return"msal.login.request"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"loginError",{get:function(){return"msal.login.error"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"renewStatus",{get:function(){return"msal.token.renew.status"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"urlHash",{get:function(){return"msal.urlHash"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"angularLoginRequest",{get:function(){return"msal.angular.login.request"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"msal",{get:function(){return"msal"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"no_account",{get:function(){return"NO_ACCOUNT"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"consumersUtid",{get:function(){return"9188040d-6c67-4c5b-b112-36a304b66dad"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"upn",{get:function(){return"upn"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"prompt_select_account",{get:function(){return"&prompt=select_account"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"prompt_none",{get:function(){return"&prompt=none"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"prompt",{get:function(){return"prompt"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"response_mode_fragment",{get:function(){return"&response_mode=fragment"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"resourceDelimiter",{get:function(){return"|"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"tokenRenewStatusCancelled",{get:function(){return"Canceled"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"tokenRenewStatusCompleted",{get:function(){return"Completed"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"tokenRenewStatusInProgress",{get:function(){return"In Progress"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"popUpWidth",{get:function(){return this._popUpWidth},set:function(e){this._popUpWidth=e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"popUpHeight",{get:function(){return this._popUpHeight},set:function(e){this._popUpHeight=e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"login",{get:function(){return"LOGIN"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"renewToken",{get:function(){return"RENEW_TOKEN"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"unknown",{get:function(){return"UNKNOWN"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"homeAccountIdentifier",{get:function(){return"homeAccountIdentifier"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"common",{get:function(){return"common"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"openidScope",{get:function(){return"openid"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"profileScope",{get:function(){return"profile"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"cacheLocationLocal",{get:function(){return"localStorage"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"cacheLocationSession",{get:function(){return"sessionStorage"},enumerable:!0,configurable:!0}),e._popUpWidth=483,e._popUpHeight=600,e}();t.Constants=n,t.CacheKeys={AUTHORITY:"msal.authority",ACQUIRE_TOKEN_ACCOUNT:"msal.acquireTokenAccount"},t.SSOTypes={ACCOUNT:"account",SID:"sid",LOGIN_HINT:"login_hint",ID_TOKEN:"id_token",DOMAIN_HINT:"domain_hint",ORGANIZATIONS:"organizations",CONSUMERS:"consumers",ACCOUNT_ID:"accountIdentifier",HOMEACCOUNT_ID:"homeAccountIdentifier",LOGIN_REQ:"login_req",DOMAIN_REQ:"domain_req"},t.PromptState={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none"},t.Library={version:"1.0.0"}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(2),i=r(4);t.ClientConfigurationErrorMessage={configurationNotSet:{code:"no_config_set",desc:"Configuration has not been set. Please call the UserAgentApplication constructor with a valid Configuration object."},invalidCacheLocation:{code:"invalid_cache_location",desc:"The cache location provided is not valid."},noStorageSupported:{code:"browser_storage_not_supported",desc:"localStorage and sessionStorage are not supported."},noRedirectCallbacksSet:{code:"no_redirect_callbacks",desc:"No redirect callbacks have been set. Please call setRedirectCallbacks() with the appropriate function arguments before continuing. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/-basics."},invalidCallbackObject:{code:"invalid_callback_object",desc:"The object passed for the callback was invalid. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/-basics."},scopesRequired:{code:"scopes_required",desc:"Scopes are required to obtain an access token."},emptyScopes:{code:"empty_input_scopes_error",desc:"Scopes cannot be passed as empty array."},nonArrayScopes:{code:"nonarray_input_scopes_error",desc:"Scopes cannot be passed as non-array."},clientScope:{code:"clientid_input_scopes_error",desc:"Client ID can only be provided as a single scope."},invalidPrompt:{code:"invalid_prompt_value",desc:"Supported prompt values are 'login', 'select_account', 'consent' and 'none'"},invalidAuthorityType:{code:"invalid_authority_type",desc:"The given authority is not a valid type of authority supported by MSAL. Please see here for valid authorities: <insert URL here>."},authorityUriInsecure:{code:"authority_uri_insecure",desc:"Authority URIs must use https."},authorityUriInvalidPath:{code:"authority_uri_invalid_path",desc:"Given authority URI is invalid."},unsupportedAuthorityValidation:{code:"unsupported_authority_validation",desc:"The authority validation is not supported for this authority type."},b2cAuthorityUriInvalidPath:{code:"b2c_authority_uri_invalid_path",desc:"The given URI for the B2C authority is invalid."},claimsRequestParsingError:{code:"claims_request_parsing_error",desc:"Could not parse the given claims request object."}};var s=function(e){function r(t,n){var o=e.call(this,t,n)||this;return o.name="ClientConfigurationError",Object.setPrototypeOf(o,r.prototype),o}return n.__extends(r,e),r.createNoSetConfigurationError=function(){return new r(t.ClientConfigurationErrorMessage.configurationNotSet.code,""+t.ClientConfigurationErrorMessage.configurationNotSet.desc)},r.createInvalidCacheLocationConfigError=function(e){return new r(t.ClientConfigurationErrorMessage.invalidCacheLocation.code,t.ClientConfigurationErrorMessage.invalidCacheLocation.desc+" Provided value: "+e+". Possible values are: "+o.Constants.cacheLocationLocal+", "+o.Constants.cacheLocationSession+".")},r.createNoStorageSupportedError=function(){return new r(t.ClientConfigurationErrorMessage.noStorageSupported.code,t.ClientConfigurationErrorMessage.noStorageSupported.desc)},r.createRedirectCallbacksNotSetError=function(){return new r(t.ClientConfigurationErrorMessage.noRedirectCallbacksSet.code,t.ClientConfigurationErrorMessage.noRedirectCallbacksSet.desc)},r.createInvalidCallbackObjectError=function(e){return new r(t.ClientConfigurationErrorMessage.invalidCallbackObject.code,t.ClientConfigurationErrorMessage.invalidCallbackObject.desc+" Given value for callback function: "+e)},r.createEmptyScopesArrayError=function(e){return new r(t.ClientConfigurationErrorMessage.emptyScopes.code,t.ClientConfigurationErrorMessage.emptyScopes.desc+" Given value: "+e+".")},r.createScopesNonArrayError=function(e){return new r(t.ClientConfigurationErrorMessage.nonArrayScopes.code,t.ClientConfigurationErrorMessage.nonArrayScopes.desc+" Given value: "+e+".")},r.createClientIdSingleScopeError=function(e){return new r(t.ClientConfigurationErrorMessage.clientScope.code,t.ClientConfigurationErrorMessage.clientScope.desc+" Given value: "+e+".")},r.createScopesRequiredError=function(e){return new r(t.ClientConfigurationErrorMessage.scopesRequired.code,t.ClientConfigurationErrorMessage.scopesRequired.desc+" Given value: "+e)},r.createInvalidPromptError=function(e){return new r(t.ClientConfigurationErrorMessage.invalidPrompt.code,t.ClientConfigurationErrorMessage.invalidPrompt.desc+" Given value: "+e)},r.createClaimsRequestParsingError=function(e){return new r(t.ClientConfigurationErrorMessage.claimsRequestParsingError.code,t.ClientConfigurationErrorMessage.claimsRequestParsingError.desc+" Given value: "+e)},r}(i.ClientAuthError);t.ClientConfigurationError=s},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(5),i=r(0);t.ClientAuthErrorMessage={multipleMatchingTokens:{code:"multiple_matching_tokens",desc:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements like authority."},multipleCacheAuthorities:{code:"multiple_authorities",desc:"Multiple authorities found in the cache. Pass authority in the API overload."},endpointResolutionError:{code:"endpoints_resolution_error",desc:"Error: could not resolve endpoints. Please check network and try again."},popUpWindowError:{code:"popup_window_error",desc:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser."},tokenRenewalError:{code:"token_renewal_error",desc:"Token renewal operation failed due to timeout."},invalidIdToken:{code:"invalid_id_token",desc:"Invalid ID token format."},invalidStateError:{code:"invalid_state_error",desc:"Invalid state."},nonceMismatchError:{code:"nonce_mismatch_error",desc:"Nonce is not matching, Nonce received: "},loginProgressError:{code:"login_progress_error",desc:"Login_In_Progress: Error during login call - login is already in progress."},acquireTokenProgressError:{code:"acquiretoken_progress_error",desc:"AcquireToken_In_Progress: Error during login call - login is already in progress."},userCancelledError:{code:"user_cancelled",desc:"User cancelled the flow."},callbackError:{code:"callback_error",desc:"Error occurred in token received callback function."},userLoginRequiredError:{code:"user_login_error",desc:"User login is required."},userDoesNotExistError:{code:"user_non_existent",desc:"User object does not exist. Please call a login API."},clientInfoDecodingError:{code:"client_info_decoding_error",desc:"The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause."},clientInfoNotPopulatedError:{code:"client_info_not_populated_error",desc:"The service did not populate client_info in the response, Please verify with the service team"},nullOrEmptyIdToken:{code:"null_or_empty_id_token",desc:"The idToken is null or empty. Please review the trace to determine the root cause."},idTokenNotParsed:{code:"id_token_parsing_error",desc:"ID token cannot be parsed. Please review stack trace to determine root cause."},tokenEncodingError:{code:"token_encoding_error",desc:"The token to be decoded is not encoded correctly."}};var s=function(e){function r(t,n){var o=e.call(this,t,n)||this;return o.name="ClientAuthError",Object.setPrototypeOf(o,r.prototype),o}return n.__extends(r,e),r.createEndpointResolutionError=function(e){var n=t.ClientAuthErrorMessage.endpointResolutionError.desc;return e&&!i.Utils.isEmpty(e)&&(n+=" Details: "+e),new r(t.ClientAuthErrorMessage.endpointResolutionError.code,n)},r.createMultipleMatchingTokensInCacheError=function(e){return new r(t.ClientAuthErrorMessage.multipleMatchingTokens.code,"Cache error for scope "+e+": "+t.ClientAuthErrorMessage.multipleMatchingTokens.desc+".")},r.createMultipleAuthoritiesInCacheError=function(e){return new r(t.ClientAuthErrorMessage.multipleCacheAuthorities.code,"Cache error for scope "+e+": "+t.ClientAuthErrorMessage.multipleCacheAuthorities.desc+".")},r.createPopupWindowError=function(e){var n=t.ClientAuthErrorMessage.popUpWindowError.desc;return e&&!i.Utils.isEmpty(e)&&(n+=" Details: "+e),new r(t.ClientAuthErrorMessage.popUpWindowError.code,n)},r.createTokenRenewalTimeoutError=function(){return new r(t.ClientAuthErrorMessage.tokenRenewalError.code,t.ClientAuthErrorMessage.tokenRenewalError.desc)},r.createInvalidIdTokenError=function(e){return new r(t.ClientAuthErrorMessage.invalidIdToken.code,t.ClientAuthErrorMessage.invalidIdToken.desc+" Given token: "+e)},r.createInvalidStateError=function(e,n){return new r(t.ClientAuthErrorMessage.invalidStateError.code,t.ClientAuthErrorMessage.invalidStateError.desc+" "+e+", state expected : "+n+".")},r.createNonceMismatchError=function(e,n){return new r(t.ClientAuthErrorMessage.nonceMismatchError.code,t.ClientAuthErrorMessage.nonceMismatchError.desc+" "+e+", nonce expected : "+n+".")},r.createLoginInProgressError=function(){return new r(t.ClientAuthErrorMessage.loginProgressError.code,t.ClientAuthErrorMessage.loginProgressError.desc)},r.createAcquireTokenInProgressError=function(){return new r(t.ClientAuthErrorMessage.acquireTokenProgressError.code,t.ClientAuthErrorMessage.acquireTokenProgressError.desc)},r.createUserCancelledError=function(){return new r(t.ClientAuthErrorMessage.userCancelledError.code,t.ClientAuthErrorMessage.userCancelledError.desc)},r.createErrorInCallbackFunction=function(e){return new r(t.ClientAuthErrorMessage.callbackError.code,t.ClientAuthErrorMessage.callbackError.desc+" "+e+".")},r.createUserLoginRequiredError=function(){return new r(t.ClientAuthErrorMessage.userLoginRequiredError.code,t.ClientAuthErrorMessage.userLoginRequiredError.desc)},r.createUserDoesNotExistError=function(){return new r(t.ClientAuthErrorMessage.userDoesNotExistError.code,t.ClientAuthErrorMessage.userDoesNotExistError.desc)},r.createClientInfoDecodingError=function(e){return new r(t.ClientAuthErrorMessage.clientInfoDecodingError.code,t.ClientAuthErrorMessage.clientInfoDecodingError.desc+" Failed with error: "+e)},r.createClientInfoNotPopulatedError=function(e){return new r(t.ClientAuthErrorMessage.clientInfoNotPopulatedError.code,t.ClientAuthErrorMessage.clientInfoNotPopulatedError.desc+" Failed with error: "+e)},r.createIdTokenNullOrEmptyError=function(e){return new r(t.ClientAuthErrorMessage.nullOrEmptyIdToken.code,t.ClientAuthErrorMessage.nullOrEmptyIdToken.desc+" Raw ID Token Value: "+e)},r.createIdTokenParsingError=function(e){return new r(t.ClientAuthErrorMessage.idTokenNotParsed.code,t.ClientAuthErrorMessage.idTokenNotParsed.desc+" Failed with error: "+e)},r.createTokenEncodingError=function(e){return new r(t.ClientAuthErrorMessage.tokenEncodingError.code,t.ClientAuthErrorMessage.tokenEncodingError.desc+" Attempted to decode: "+e)},r}(o.AuthError);t.ClientAuthError=s},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(1);t.AuthErrorMessage={unexpectedError:{code:"unexpected_error",desc:"Unexpected error in authentication."}};var o=function(e){function r(t,n){var o=e.call(this,n)||this;return Object.setPrototypeOf(o,r.prototype),o.errorCode=t,o.errorMessage=n,o.name="AuthError",o}return n.__extends(r,e),r.createUnexpectedError=function(e){return new r(t.AuthErrorMessage.unexpectedError.code,t.AuthErrorMessage.unexpectedError.desc+": "+e)},r}(Error);t.AuthError=o},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n,o=r(0),i=r(3),s=r(12);(n=t.AuthorityType||(t.AuthorityType={}))[n.Aad=0]="Aad",n[n.Adfs=1]="Adfs",n[n.B2C=2]="B2C";var a=function(){function e(e,t){this.IsValidationEnabled=t,this.CanonicalAuthority=e,this.validateAsUri()}return Object.defineProperty(e.prototype,"Tenant",{get:function(){return this.CanonicalAuthorityUrlComponents.PathSegments[0]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"AuthorizationEndpoint",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.AuthorizationEndpoint.replace("{tenant}",this.Tenant)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"EndSessionEndpoint",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.EndSessionEndpoint.replace("{tenant}",this.Tenant)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"SelfSignedJwtAudience",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.Issuer.replace("{tenant}",this.Tenant)},enumerable:!0,configurable:!0}),e.prototype.validateResolved=function(){if(!this.tenantDiscoveryResponse)throw"Please call ResolveEndpointsAsync first"},Object.defineProperty(e.prototype,"CanonicalAuthority",{get:function(){return this.canonicalAuthority},set:function(e){this.canonicalAuthority=o.Utils.CanonicalizeUri(e),this.canonicalAuthorityUrlComponents=null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CanonicalAuthorityUrlComponents",{get:function(){return this.canonicalAuthorityUrlComponents||(this.canonicalAuthorityUrlComponents=o.Utils.GetUrlComponents(this.CanonicalAuthority)),this.canonicalAuthorityUrlComponents},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"DefaultOpenIdConfigurationEndpoint",{get:function(){return this.CanonicalAuthority+"v2.0/.well-known/openid-configuration"},enumerable:!0,configurable:!0}),e.prototype.validateAsUri=function(){var e;try{e=this.CanonicalAuthorityUrlComponents}catch(e){throw i.ClientConfigurationErrorMessage.invalidAuthorityType}if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw i.ClientConfigurationErrorMessage.authorityUriInsecure;if(!e.PathSegments||e.PathSegments.length<1)throw i.ClientConfigurationErrorMessage.authorityUriInvalidPath},e.prototype.DiscoverEndpoints=function(e){return(new s.XhrClient).sendRequestAsync(e,"GET",!0).then((function(e){return{AuthorizationEndpoint:e.authorization_endpoint,EndSessionEndpoint:e.end_session_endpoint,Issuer:e.issuer}}))},e.prototype.resolveEndpointsAsync=function(){var e=this,t="";return this.GetOpenIdConfigurationEndpointAsync().then((function(r){return t=r,e.DiscoverEndpoints(t)})).then((function(t){return e.tenantDiscoveryResponse=t,e}))},e}();t.Authority=a},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n,o,i=r(0);(o=n=t.LogLevel||(t.LogLevel={}))[o.Error=0]="Error",o[o.Warning=1]="Warning",o[o.Info=2]="Info",o[o.Verbose=3]="Verbose";var s=function(){function e(e,t){void 0===t&&(t={}),this.level=n.Info;var r=t.correlationId,o=void 0===r?"":r,i=t.level,s=void 0===i?n.Info:i,a=t.piiLoggingEnabled,c=void 0!==a&&a;this.localCallback=e,this.correlationId=o,this.level=s,this.piiLoggingEnabled=c}return e.prototype.logMessage=function(e,t,r){if(!(e>this.level||!this.piiLoggingEnabled&&r)){var o,s=(new Date).toUTCString();o=i.Utils.isEmpty(this.correlationId)?s+":"+i.Utils.getLibraryVersion()+"-"+n[e]+" "+t:s+":"+this.correlationId+"-"+i.Utils.getLibraryVersion()+"-"+n[e]+" "+t,this.executeCallback(e,o,r)}},e.prototype.executeCallback=function(e,t,r){this.localCallback&&this.localCallback(e,t,r)},e.prototype.error=function(e){this.logMessage(n.Error,e,!1)},e.prototype.errorPii=function(e){this.logMessage(n.Error,e,!0)},e.prototype.warning=function(e){this.logMessage(n.Warning,e,!1)},e.prototype.warningPii=function(e){this.logMessage(n.Warning,e,!0)},e.prototype.info=function(e){this.logMessage(n.Info,e,!1)},e.prototype.infoPii=function(e){this.logMessage(n.Info,e,!0)},e.prototype.verbose=function(e){this.logMessage(n.Verbose,e,!1)},e.prototype.verbosePii=function(e){this.logMessage(n.Verbose,e,!0)},e}();t.Logger=s},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(5);t.ServerErrorMessage={serverUnavailable:{code:"server_unavailable",desc:"Server is temporarily unavailable."},unknownServerError:{code:"unknown_server_error"}};var i=function(e){function r(t,n){var o=e.call(this,t,n)||this;return o.name="ServerError",Object.setPrototypeOf(o,r.prototype),o}return n.__extends(r,e),r.createServerUnavailableError=function(){return new r(t.ServerErrorMessage.serverUnavailable.code,t.ServerErrorMessage.serverUnavailable.desc)},r.createUnknownServerError=function(e){return new r(t.ServerErrorMessage.unknownServerError.code,e)},r}(o.AuthError);t.ServerError=i},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(19),i=r(20),s=r(21),a=r(22),c=r(2),u=r(23),l=r(24),d=r(10),h=r(0),p=r(26),f=r(13),g=r(14),y=r(3),m=r(5),C=r(4),v=r(8),w=r(15),I=r(16),S="id_token",E="token",b="id_token token",A=function(e,t,r){var n=r.value;return r.value=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.isInIframe()?new Promise((function(){})):n.apply(this,e)},r},k=function(){function e(e){this.authResponseCallback=null,this.tokenReceivedCallback=null,this.errorReceivedCallback=null,this.config=f.buildConfiguration(e),this.redirectCallbacksSet=!1,this.logger=this.config.system.logger,this.clientId=this.config.auth.clientId,this.inCookie=this.config.cache.storeAuthStateInCookie,this.authority=this.config.auth.authority||"https://login.microsoftonline.com/common",this.loginInProgress=!1,this.acquireTokenInProgress=!1;try{this.cacheStorage=new l.Storage(this.config.cache.cacheLocation)}catch(e){throw y.ClientConfigurationError.createInvalidCacheLocationConfigError(this.config.cache.cacheLocation)}window.openedWindows=[],window.activeRenewals={},window.renewStates=[],window.callbackMappedToRenewStates={},window.promiseMappedToRenewStates={},window.msal=this;var t=window.location.hash,r=this.isCallback(t);this.config.framework.isAngular||r&&this.handleAuthenticationResponse(t)}return Object.defineProperty(e.prototype,"authority",{get:function(){return this.authorityInstance.CanonicalAuthority},set:function(e){this.authorityInstance=p.AuthorityFactory.CreateInstance(e,this.config.auth.validateAuthority)},enumerable:!0,configurable:!0}),e.prototype.getAuthorityInstance=function(){return this.authorityInstance},e.prototype.handleRedirectCallback=function(e,t){if(!e)throw this.redirectCallbacksSet=!1,y.ClientConfigurationError.createInvalidCallbackObjectError(e);if(t?(this.tokenReceivedCallback=e,this.errorReceivedCallback=t,this.logger.warning("This overload for callback is deprecated - please change the format of the callbacks to a single callback as shown: (err: AuthError, response: AuthResponse).")):this.authResponseCallback=e,this.redirectCallbacksSet=!0,!this.config.framework.isAngular){var r=this.cacheStorage.getItem(c.Constants.urlHash);r&&this.processCallBack(r,null)}},e.prototype.redirectSuccessHandler=function(e){this.errorReceivedCallback?this.tokenReceivedCallback(e):this.authResponseCallback&&this.authResponseCallback(null,e)},e.prototype.redirectErrorHandler=function(e,t){this.errorReceivedCallback?this.errorReceivedCallback(e,t.accountState):this.authResponseCallback(e,t)},e.prototype.loginRedirect=function(e){var t=this;if(!this.redirectCallbacksSet)throw y.ClientConfigurationError.createRedirectCallbacksNotSetError();if(this.loginInProgress){var r=void 0;return e&&(r=e.state),void this.redirectErrorHandler(C.ClientAuthError.createLoginInProgressError(),I.buildResponseStateOnly(r))}var n=this.appendScopes(e);this.validateInputScope(n,!1);var o=this.getAccount();if(h.Utils.isSSOParam(e))this.loginRedirectHelper(o,e,n);else if(this.extractADALIdToken()&&!n){this.logger.info("ADAL's idToken exists. Extracting login information from ADAL's idToken ");var i=this.buildIDTokenRequest(e);this.silentLogin=!0,this.acquireTokenSilent(i).then((function(e){t.silentLogin=!1,t.logger.info("Unified cache call is successful"),t.redirectCallbacksSet&&t.redirectSuccessHandler(e)}),(function(r){t.silentLogin=!1,t.logger.error("Error occurred during unified cache ATS"),t.loginRedirectHelper(null,e,n)}))}else this.loginRedirectHelper(null,e,n)},e.prototype.loginRedirectHelper=function(e,t,r){var n=this;this.loginInProgress=!0,this.authorityInstance.resolveEndpointsAsync().then((function(){var o=new s.ServerRequestParameters(n.authorityInstance,n.clientId,r,S,n.getRedirectUri(),t.state);o=n.populateQueryParams(e,t,o);var i=n.cacheStorage.getItem(c.Constants.angularLoginRequest);i&&""!==i?n.cacheStorage.setItem(c.Constants.angularLoginRequest,""):i=window.location.href,n.updateCacheEntries(o,e,i);var a=o.createNavigateUrl(r)+c.Constants.response_mode_fragment;n.promptUser(a)})).catch((function(e){var r;n.logger.warning("could not resolve endpoints"),t&&(r=t.state),n.redirectErrorHandler(C.ClientAuthError.createEndpointResolutionError(e.toString),I.buildResponseStateOnly(r))}))},e.prototype.acquireTokenRedirect=function(e){var t=this;if(!this.redirectCallbacksSet)throw y.ClientConfigurationError.createRedirectCallbacksNotSetError();this.validateInputScope(e.scopes,!0);var r,n=e.account||this.getAccount();if(this.acquireTokenInProgress){var o=void 0;return e&&(o=e.state),void this.redirectErrorHandler(C.ClientAuthError.createAcquireTokenInProgressError(),I.buildResponseStateOnly(this.getAccountState(o)))}if(!n&&!e.sid&&!e.loginHint)throw this.logger.info("User login is required"),C.ClientAuthError.createUserLoginRequiredError();var i=e.authority?p.AuthorityFactory.CreateInstance(e.authority,this.config.auth.validateAuthority):this.authorityInstance;this.acquireTokenInProgress=!0,i.resolveEndpointsAsync().then((function(){var o=t.getTokenType(n,e.scopes,!1);r=new s.ServerRequestParameters(i,t.clientId,e.scopes,o,t.getRedirectUri(),e.state),t.updateCacheEntries(r,n);var a=(r=t.populateQueryParams(n,e,r)).createNavigateUrl(e.scopes)+c.Constants.response_mode_fragment;a&&(t.cacheStorage.setItem(c.Constants.stateAcquireToken,r.state,t.inCookie),window.location.replace(a))})).catch((function(r){var n;t.logger.warning("could not resolve endpoints"),e&&(n=e.state),t.redirectErrorHandler(C.ClientAuthError.createEndpointResolutionError(r.toString),I.buildResponseStateOnly(n))}))},e.prototype.isCallback=function(e){e=this.getHash(e);var t=h.Utils.deserialize(e);return t.hasOwnProperty(c.Constants.errorDescription)||t.hasOwnProperty(c.Constants.error)||t.hasOwnProperty(c.Constants.accessToken)||t.hasOwnProperty(c.Constants.idToken)},e.prototype.loginPopup=function(e){var t=this;return new Promise((function(r,n){if(t.loginInProgress)return n(C.ClientAuthError.createLoginInProgressError());var o=t.appendScopes(e);t.validateInputScope(o,!1);var i=t.getAccount();if(h.Utils.isSSOParam(e))t.loginPopupHelper(i,e,r,n,o);else if(t.extractADALIdToken()&&!o){t.logger.info("ADAL's idToken exists. Extracting login information from ADAL's idToken ");var s=t.buildIDTokenRequest(e);t.silentLogin=!0,t.acquireTokenSilent(s).then((function(e){t.silentLogin=!1,t.logger.info("Unified cache call is successful"),r(e)}),(function(i){t.silentLogin=!1,t.logger.error("Error occurred during unified cache ATS"),t.loginPopupHelper(null,e,r,n,o)}))}else t.loginPopupHelper(null,e,r,n,o)}))},e.prototype.loginPopupHelper=function(e,t,r,n,o){var i=this;o||(o=[this.clientId]);var a=o.join(" ").toLowerCase(),u=this.openWindow("about:blank","_blank",1,this,r,n);u&&(this.loginInProgress=!0,this.authorityInstance.resolveEndpointsAsync().then((function(){var l=new s.ServerRequestParameters(i.authorityInstance,i.clientId,o,S,i.getRedirectUri(),t.state);l=i.populateQueryParams(e,t,l),i.updateCacheEntries(l,e,window.location.href),i.cacheStorage.setItem(c.Constants.loginRequest,window.location.href,i.inCookie),i.cacheStorage.setItem(c.Constants.loginError,""),i.cacheStorage.setItem(c.Constants.nonceIdToken,l.nonce,i.inCookie),i.cacheStorage.setItem(c.Constants.msalError,""),i.cacheStorage.setItem(c.Constants.msalErrorDescription,""),i.setAuthorityCache(l.state,i.authority);var d=l.createNavigateUrl(o)+c.Constants.response_mode_fragment;window.renewStates.push(l.state),window.requestType=c.Constants.login,i.registerCallback(l.state,a,r,n),u&&(i.logger.infoPii("Navigated Popup window to:"+d),u.location.href=d)}),(function(){i.logger.info(C.ClientAuthErrorMessage.endpointResolutionError.code+":"+C.ClientAuthErrorMessage.endpointResolutionError.desc),i.cacheStorage.setItem(c.Constants.msalError,C.ClientAuthErrorMessage.endpointResolutionError.code),i.cacheStorage.setItem(c.Constants.msalErrorDescription,C.ClientAuthErrorMessage.endpointResolutionError.desc),n&&n(C.ClientAuthError.createEndpointResolutionError()),u&&u.close()})).catch((function(e){i.logger.warning("could not resolve endpoints"),n(C.ClientAuthError.createEndpointResolutionError(e.toString))})))},e.prototype.acquireTokenPopup=function(e){var t=this;return new Promise((function(r,n){t.validateInputScope(e.scopes,!0);var o,i=e.scopes.join(" ").toLowerCase(),a=e.account||t.getAccount();if(t.acquireTokenInProgress)return n(C.ClientAuthError.createAcquireTokenInProgressError());if(!a&&(e.sid||e.loginHint))return t.logger.info("User login is required"),n(C.ClientAuthError.createUserLoginRequiredError());t.acquireTokenInProgress=!0;var u=e.authority?p.AuthorityFactory.CreateInstance(e.authority,t.config.auth.validateAuthority):t.authorityInstance,l=t.openWindow("about:blank","_blank",1,t,r,n);l&&u.resolveEndpointsAsync().then((function(){var d=t.getTokenType(a,e.scopes,!1);o=new s.ServerRequestParameters(u,t.clientId,e.scopes,d,t.getRedirectUri(),e.state),o=t.populateQueryParams(a,e,o),t.updateCacheEntries(o,a);var h=o.createNavigateUrl(e.scopes)+c.Constants.response_mode_fragment;window.renewStates.push(o.state),window.requestType=c.Constants.renewToken,t.registerCallback(o.state,i,r,n),l&&(l.location.href=h)}),(function(){t.logger.info(C.ClientAuthErrorMessage.endpointResolutionError.code+":"+C.ClientAuthErrorMessage.endpointResolutionError.desc),t.cacheStorage.setItem(c.Constants.msalError,C.ClientAuthErrorMessage.endpointResolutionError.code),t.cacheStorage.setItem(c.Constants.msalErrorDescription,C.ClientAuthErrorMessage.endpointResolutionError.desc),n&&n(C.ClientAuthError.createEndpointResolutionError()),l&&l.close()})).catch((function(e){t.logger.warning("could not resolve endpoints"),n(C.ClientAuthError.createEndpointResolutionError(e.toString()))}))}))},e.prototype.openWindow=function(e,t,r,n,o,i){var s,a=this;try{s=this.openPopup(e,t,c.Constants.popUpWidth,c.Constants.popUpHeight)}catch(e){return n.loginInProgress=!1,n.acquireTokenInProgress=!1,this.logger.info(C.ClientAuthErrorMessage.popUpWindowError.code+":"+C.ClientAuthErrorMessage.popUpWindowError.desc),this.cacheStorage.setItem(c.Constants.msalError,C.ClientAuthErrorMessage.popUpWindowError.code),this.cacheStorage.setItem(c.Constants.msalErrorDescription,C.ClientAuthErrorMessage.popUpWindowError.desc),i&&i(C.ClientAuthError.createPopupWindowError()),null}window.openedWindows.push(s);var u=window.setInterval((function(){if(s&&s.closed&&n.loginInProgress){if(i&&i(C.ClientAuthError.createUserCancelledError()),window.clearInterval(u),a.config.framework.isAngular)return void a.broadcast("msal:popUpClosed",C.ClientAuthErrorMessage.userCancelledError.code+c.Constants.resourceDelimiter+C.ClientAuthErrorMessage.userCancelledError.desc);n.loginInProgress=!1,n.acquireTokenInProgress=!1}try{var e=s.location;if(-1!==e.href.indexOf(a.getRedirectUri())&&(window.clearInterval(u),n.loginInProgress=!1,n.acquireTokenInProgress=!1,a.logger.info("Closing popup window"),a.config.framework.isAngular)){a.broadcast("msal:popUpHashChanged",e.hash);for(var t=0;t<window.openedWindows.length;t++)window.openedWindows[t].close()}}catch(e){}}),r);return s},e.prototype.openPopup=function(e,t,r,n){try{var o=window.screenLeft?window.screenLeft:window.screenX,i=window.screenTop?window.screenTop:window.screenY,s=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,a=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,c=s/2-r/2+o,u=a/2-n/2+i,l=window.open(e,t,"width="+r+", height="+n+", top="+u+", left="+c);if(!l)throw C.ClientAuthError.createPopupWindowError();return l.focus&&l.focus(),l}catch(e){throw this.logger.error("error opening popup "+e.message),this.loginInProgress=!1,this.acquireTokenInProgress=!1,C.ClientAuthError.createPopupWindowError(e.toString())}},e.prototype.acquireTokenSilent=function(e){var t=this;return new Promise((function(r,n){t.validateInputScope(e.scopes,!0);var o=e.scopes.join(" ").toLowerCase(),i=e.account||t.getAccount(),a=t.cacheStorage.getItem(c.Constants.adalIdToken);if(!i&&(e.sid||e.loginHint)&&h.Utils.isEmpty(a))return t.logger.info("User login is required"),n(C.ClientAuthError.createUserLoginRequiredError());var u=t.getTokenType(i,e.scopes,!0),l=new s.ServerRequestParameters(p.AuthorityFactory.CreateInstance(e.authority,t.config.auth.validateAuthority),t.clientId,e.scopes,u,t.getRedirectUri(),e.state);if(h.Utils.isSSOParam(e)||i)l=t.populateQueryParams(i,e,l);else if(!i&&!h.Utils.isEmpty(a)){var d=h.Utils.extractIdToken(a);t.logger.verbose("ADAL's idToken exists. Extracting login information from ADAL's idToken "),l=t.populateQueryParams(i,null,l,d)}var f,g,y=e.claimsRequest||l.claimsValue;if(!y)try{g=t.getCachedToken(l,i)}catch(r){f=r}return g?(t.logger.info("Token is already in cache for scope:"+o),r(g),null):f?(t.logger.infoPii(f.errorCode+":"+f.errorMessage),n(f),null):(y?t.logger.verbose("Skipped cache lookup since claims were given."):t.logger.verbose("Token is not in cache for scope:"+o),l.authorityInstance||(l.authorityInstance=e.authority?p.AuthorityFactory.CreateInstance(e.authority,t.config.auth.validateAuthority):t.authorityInstance),l.authorityInstance.resolveEndpointsAsync().then((function(){window.activeRenewals[o]?(t.logger.verbose("Renew token for scope: "+o+" is in progress. Registering callback"),t.registerCallback(window.activeRenewals[o],o,r,n)):e.scopes&&-1<e.scopes.indexOf(t.clientId)&&1===e.scopes.length?(t.logger.verbose("renewing idToken"),t.renewIdToken(e.scopes,r,n,i,l)):(t.logger.verbose("renewing accesstoken"),t.renewToken(e.scopes,r,n,i,l))})).catch((function(e){return t.logger.warning("could not resolve endpoints"),n(C.ClientAuthError.createEndpointResolutionError(e.toString())),null})))}))},e.prototype.isInIframe=function(){return window.parent!==window},e.prototype.parentIsMsal=function(){return window.parent!==window&&window.parent.msal},e.prototype.isInteractionRequired=function(e){return-1!==e.indexOf("interaction_required")||-1!==e.indexOf("consent_required")||-1!==e.indexOf("login_required")},e.prototype.loadIframeTimeout=function(e,t,r){var n=this,o=window.activeRenewals[r];this.logger.verbose("Set loading state to pending for: "+r+":"+o),this.cacheStorage.setItem(c.Constants.renewStatus+o,c.Constants.tokenRenewStatusInProgress),this.loadFrame(e,t),setTimeout((function(){n.cacheStorage.getItem(c.Constants.renewStatus+o)===c.Constants.tokenRenewStatusInProgress&&(n.logger.verbose("Loading frame has timed out after: "+n.config.system.loadFrameTimeout/1e3+" seconds for scope "+r+":"+o),o&&window.callbackMappedToRenewStates[o]&&window.callbackMappedToRenewStates[o](null,C.ClientAuthError.createTokenRenewalTimeoutError()),n.cacheStorage.setItem(c.Constants.renewStatus+o,c.Constants.tokenRenewStatusCancelled))}),this.config.system.loadFrameTimeout)},e.prototype.loadFrame=function(e,t){var r=this;this.logger.info("LoadFrame: "+t);var n=t;setTimeout((function(){var o=r.addHiddenIFrame(n);""!==o.src&&"about:blank"!==o.src||(o.src=e,r.logger.infoPii("Frame Name : "+t+" Navigated to: "+e))}),this.config.system.navigateFrameWait)},e.prototype.addHiddenIFrame=function(e){if(void 0===e)return null;this.logger.info("Add msal frame to document:"+e);var t=document.getElementById(e);if(!t){if(document.createElement&&document.documentElement&&-1===window.navigator.userAgent.indexOf("MSIE 5.0")){var r=document.createElement("iframe");r.setAttribute("id",e),r.style.visibility="hidden",r.style.position="absolute",r.style.width=r.style.height="0",r.style.border="0",t=document.getElementsByTagName("body")[0].appendChild(r)}else document.body&&document.body.insertAdjacentHTML&&document.body.insertAdjacentHTML("beforeend","<iframe name='"+e+"' id='"+e+"' style='display:none'></iframe>");window.frames&&window.frames[e]&&(t=window.frames[e])}return t},e.prototype.addHintParameters=function(e,t,r){var n=e||this.getAccount();return n&&(n.sid&&r.promptValue===c.PromptState.NONE?t[c.SSOTypes.SID]||t[c.SSOTypes.LOGIN_HINT]||(t=h.Utils.addSSOParameter(c.SSOTypes.SID,n.sid,t)):t[c.SSOTypes.LOGIN_HINT]||!n.userName||h.Utils.isEmpty(n.userName)||(t=h.Utils.addSSOParameter(c.SSOTypes.LOGIN_HINT,n.userName,t)),t[c.SSOTypes.DOMAIN_REQ]||t[c.SSOTypes.LOGIN_REQ]||(t=h.Utils.addSSOParameter(c.SSOTypes.HOMEACCOUNT_ID,n.homeAccountIdentifier,t))),t},e.prototype.promptUser=function(e){if(!e||h.Utils.isEmpty(e))throw this.logger.info("Navigate url is empty"),m.AuthError.createUnexpectedError("Navigate url is empty");this.logger.infoPii("Navigate to:"+e),window.location.replace(e)},e.prototype.registerCallback=function(e,t,r,n){var o=this;window.activeRenewals[t]=e,window.promiseMappedToRenewStates[e]||(window.promiseMappedToRenewStates[e]=[]),window.promiseMappedToRenewStates[e].push({resolve:r,reject:n}),window.callbackMappedToRenewStates[e]||(window.callbackMappedToRenewStates[e]=function(r,n){window.activeRenewals[t]=null;for(var i=0;i<window.promiseMappedToRenewStates[e].length;++i)try{if(n)window.promiseMappedToRenewStates[e][i].reject(n);else{if(!r)throw m.AuthError.createUnexpectedError("Error and response are both null");window.promiseMappedToRenewStates[e][i].resolve(r)}}catch(r){o.logger.warning(r)}window.promiseMappedToRenewStates[e]=null,window.callbackMappedToRenewStates[e]=null})},e.prototype.logout=function(){this.clearCache(),this.account=null;var e="";this.getPostLogoutRedirectUri()&&(e="post_logout_redirect_uri="+encodeURIComponent(this.getPostLogoutRedirectUri()));var t=this.authority+"oauth2/v2.0/logout?"+e;this.promptUser(t)},e.prototype.clearCache=function(){window.renewStates=[];for(var e=this.cacheStorage.getAllAccessTokens(c.Constants.clientId,c.Constants.homeAccountIdentifier),t=0;t<e.length;t++)this.cacheStorage.removeItem(JSON.stringify(e[t].key));this.cacheStorage.resetCacheItems(),this.cacheStorage.clearCookie()},e.prototype.clearCacheForScope=function(e){for(var t=this.cacheStorage.getAllAccessTokens(c.Constants.clientId,c.Constants.homeAccountIdentifier),r=0;r<t.length;r++){var n=t[r];n.value.accessToken===e&&this.cacheStorage.removeItem(JSON.stringify(n.key))}},e.prototype.processCallBack=function(e,t,r){var n,o;this.logger.info("Processing the callback from redirect response"),t||(t=this.getResponseState(e));try{n=this.saveTokenFromHash(e,t)}catch(e){o=e}this.cacheStorage.removeItem(c.Constants.urlHash);try{this.cacheStorage.clearCookie();var i=this.getAccountState(t.state);if(n){if(t.requestType===c.Constants.renewToken||n.accessToken?(window.parent!==window?this.logger.verbose("Window is in iframe, acquiring token silently"):this.logger.verbose("acquiring token interactive in progress"),n.tokenType=c.Constants.accessToken):t.requestType===c.Constants.login&&(n.tokenType=c.Constants.idToken),!r)return void this.redirectSuccessHandler(n)}else if(!r)return void this.redirectErrorHandler(o,I.buildResponseStateOnly(i));r(n,o)}catch(e){throw this.logger.error("Error occurred in token received callback function: "+e),C.ClientAuthError.createErrorInCallbackFunction(e.toString())}},e.prototype.handleAuthenticationResponse=function(e){null==e&&(e=window.location.hash);var t=null,r=!1,n=!1;try{n=window.opener&&window.opener.msal&&window.opener.msal!==window.msal}catch(e){n=!1}n?(t=window.opener.msal,r=!0):window.parent&&window.parent.msal&&(t=window.parent.msal);var o=t.getResponseState(e),i=null;if(t.logger.info("Returned from redirect url"),this.parentIsMsal())i=window.parent.callbackMappedToRenewStates[o.state];else if(n)i=window.opener.callbackMappedToRenewStates[o.state];else{if(i=null,t.config.auth.navigateToLoginRequestUrl)return t.cacheStorage.setItem(c.Constants.urlHash,e),void(window.parent!==window||r||(window.location.href=t.cacheStorage.getItem(c.Constants.loginRequest,t.inCookie)));if(window.location.hash="",!this.redirectCallbacksSet)return}if(t.processCallBack(e,o,i),n)for(var s=0;s<window.opener.openedWindows.length;s++)window.opener.openedWindows[s].close()},e.prototype.deserializeHash=function(e){return e=this.getHash(e),h.Utils.deserialize(e)},e.prototype.getResponseState=function(e){var t,r=this.deserializeHash(e);if(!r)throw m.AuthError.createUnexpectedError("Hash was not parsed correctly.");if(!r.hasOwnProperty("state"))throw m.AuthError.createUnexpectedError("Hash does not contain state.");if((t={requestType:c.Constants.unknown,state:r.state,stateMatch:!1}).state===this.cacheStorage.getItem(c.Constants.stateLogin,this.inCookie)||t.state===this.silentAuthenticationState)return t.requestType=c.Constants.login,t.stateMatch=!0,t;if(t.state===this.cacheStorage.getItem(c.Constants.stateAcquireToken,this.inCookie))return t.requestType=c.Constants.renewToken,t.stateMatch=!0,t;if(!t.stateMatch){t.requestType=window.requestType;for(var n=window.renewStates,o=0;o<n.length;o++)if(n[o]===t.state){t.stateMatch=!0;break}}return t},e.prototype.getCachedToken=function(e,t){var r=null,n=e.scopes,o=this.cacheStorage.getAllAccessTokens(this.clientId,t?t.homeAccountIdentifier:null);if(0===o.length)return null;var i=[];if(e.authority){for(s=0;s<o.length;s++)l=(a=o[s]).key.scopes.split(" "),h.Utils.containsScope(l,n)&&h.Utils.CanonicalizeUri(a.key.authority)===e.authority&&i.push(a);if(0===i.length)return null;if(1!==i.length)throw C.ClientAuthError.createMultipleMatchingTokensInCacheError(n.toString());r=i[0]}else{for(var s=0;s<o.length;s++){var a,l=(a=o[s]).key.scopes.split(" ");h.Utils.containsScope(l,n)&&i.push(a)}if(1===i.length)r=i[0],e.authorityInstance=p.AuthorityFactory.CreateInstance(r.key.authority,this.config.auth.validateAuthority);else{if(1<i.length)throw C.ClientAuthError.createMultipleMatchingTokensInCacheError(n.toString());var d=this.getUniqueAuthority(o,"authority");if(1<d.length)throw C.ClientAuthError.createMultipleAuthoritiesInCacheError(n.toString());e.authorityInstance=p.AuthorityFactory.CreateInstance(d[0],this.config.auth.validateAuthority)}}if(null==r)return null;var f=Number(r.value.expiresIn),g=this.config.system.tokenRenewalOffsetSeconds||300;if(f&&f>h.Utils.now()+g){var y=new u.IdToken(r.value.idToken);if(!t&&!(t=this.getAccount()))throw m.AuthError.createUnexpectedError("Account should not be null here.");var v=this.getAccountState(e.state),w={uniqueId:"",tenantId:"",tokenType:r.value.idToken===r.value.accessToken?c.Constants.idToken:c.Constants.accessToken,idToken:y,accessToken:r.value.accessToken,scopes:r.key.scopes.split(" "),expiresOn:new Date(1e3*f),account:t,accountState:v};return h.Utils.setResponseIdToken(w,y),w}return this.cacheStorage.removeItem(JSON.stringify(i[0].key)),null},e.prototype.getUniqueAuthority=function(e,t){var r=[],n=[];return e.forEach((function(e){e.key.hasOwnProperty(t)&&-1===n.indexOf(e.key[t])&&(n.push(e.key[t]),r.push(e.key[t]))})),r},e.prototype.extractADALIdToken=function(){var e=this.cacheStorage.getItem(c.Constants.adalIdToken);return h.Utils.isEmpty(e)?null:h.Utils.extractIdToken(e)},e.prototype.renewToken=function(e,t,r,n,o){var i=e.join(" ").toLowerCase();this.logger.verbose("renewToken is called for scope:"+i);var s=this.addHiddenIFrame("msalRenewFrame"+i);this.updateCacheEntries(o,n),this.logger.verbose("Renew token Expected state: "+o.state);var a=h.Utils.urlRemoveQueryStringParameter(o.createNavigateUrl(e),c.Constants.prompt)+c.Constants.prompt_none;window.renewStates.push(o.state),window.requestType=c.Constants.renewToken,this.registerCallback(o.state,i,t,r),this.logger.infoPii("Navigate to:"+a),s.src="about:blank",this.loadIframeTimeout(a,"msalRenewFrame"+i,i)},e.prototype.renewIdToken=function(e,t,r,n,o){this.logger.info("renewidToken is called");var i=this.addHiddenIFrame("msalIdTokenFrame");this.updateCacheEntries(o,n),this.logger.verbose("Renew Idtoken Expected state: "+o.state);var s=h.Utils.urlRemoveQueryStringParameter(o.createNavigateUrl(e),c.Constants.prompt)+c.Constants.prompt_none;this.silentLogin?(window.requestType=c.Constants.login,this.silentAuthenticationState=o.state):(window.requestType=c.Constants.renewToken,window.renewStates.push(o.state)),this.registerCallback(o.state,this.clientId,t,r),this.logger.infoPii("Navigate to:"+s),i.src="about:blank",this.loadIframeTimeout(s,"msalIdTokenFrame",this.clientId)},e.prototype.saveAccessToken=function(e,t,r,s){var u,l=n.__assign({},e),d=new a.ClientInfo(s);if(r.hasOwnProperty("scope")){for(var p=(u=r.scope).split(" "),f=this.cacheStorage.getAllAccessTokens(this.clientId,t),g=0;g<f.length;g++){var y=f[g];if(y.key.homeAccountIdentifier===e.account.homeAccountIdentifier){var m=y.key.scopes.split(" ");h.Utils.isIntersectingScopes(m,p)&&this.cacheStorage.removeItem(JSON.stringify(y.key))}}var C=h.Utils.expiresIn(r[c.Constants.expiresIn]).toString(),v=new o.AccessTokenKey(t,this.clientId,u,d.uid,d.utid),w=new i.AccessTokenValue(r[c.Constants.accessToken],e.idToken.rawIdToken,C,s);this.cacheStorage.setItem(JSON.stringify(v),JSON.stringify(w)),l.accessToken=r[c.Constants.accessToken],l.scopes=p,(I=Number(C))?l.expiresOn=new Date(1e3*(h.Utils.now()+I)):this.logger.error("Could not parse expiresIn parameter. Given value: "+C)}else{var I;u=this.clientId,v=new o.AccessTokenKey(t,this.clientId,u,d.uid,d.utid),w=new i.AccessTokenValue(r[c.Constants.idToken],r[c.Constants.idToken],e.idToken.expiration,s),this.cacheStorage.setItem(JSON.stringify(v),JSON.stringify(w)),l.scopes=[u],l.accessToken=r[c.Constants.idToken],(I=Number(e.idToken.expiration))?l.expiresOn=new Date(1e3*I):this.logger.error("Could not parse expiresIn parameter")}return l},e.prototype.saveTokenFromHash=function(e,t){this.logger.info("State status:"+t.stateMatch+"; Request type:"+t.requestType),this.cacheStorage.setItem(c.Constants.msalError,""),this.cacheStorage.setItem(c.Constants.msalErrorDescription,"");var r,n={uniqueId:"",tenantId:"",tokenType:"",idToken:null,accessToken:null,scopes:[],expiresOn:null,account:null,accountState:""},o=this.deserializeHash(e),i="",s="";if(o.hasOwnProperty(c.Constants.errorDescription)||o.hasOwnProperty(c.Constants.error)){if(this.logger.infoPii("Error :"+o[c.Constants.error]+"; Error description:"+o[c.Constants.errorDescription]),this.cacheStorage.setItem(c.Constants.msalError,o[c.Constants.error]),this.cacheStorage.setItem(c.Constants.msalErrorDescription,o[c.Constants.errorDescription]),t.requestType===c.Constants.login&&(this.loginInProgress=!1,this.cacheStorage.setItem(c.Constants.loginError,o[c.Constants.errorDescription]+":"+o[c.Constants.error]),i=l.Storage.generateAuthorityKey(t.state)),t.requestType===c.Constants.renewToken){this.acquireTokenInProgress=!1,i=l.Storage.generateAuthorityKey(t.state);var p,f=this.getAccount();p=f&&!h.Utils.isEmpty(f.homeAccountIdentifier)?f.homeAccountIdentifier:c.Constants.no_account,s=l.Storage.generateAcquireTokenAccountKey(p,t.state)}r=this.isInteractionRequired(o[c.Constants.errorDescription])?new w.InteractionRequiredAuthError(o[c.Constants.error],o[c.Constants.errorDescription]):new v.ServerError(o[c.Constants.error],o[c.Constants.errorDescription])}else if(t.stateMatch){this.logger.info("State is right"),o.hasOwnProperty(c.Constants.sessionState)&&this.cacheStorage.setItem(c.Constants.msalSessionState,o[c.Constants.sessionState]),n.accountState=this.getAccountState(t.state);var g="";if(o.hasOwnProperty(c.Constants.accessToken)){this.logger.info("Fragment has access token"),this.acquireTokenInProgress=!1,o.hasOwnProperty(c.Constants.idToken)?n.idToken=new u.IdToken(o[c.Constants.idToken]):n=h.Utils.setResponseIdToken(n,new u.IdToken(this.cacheStorage.getItem(c.Constants.idTokenKey)));var y=l.Storage.generateAuthorityKey(t.state),I=this.cacheStorage.getItem(y,this.inCookie);if(h.Utils.isEmpty(I)||(I=h.Utils.replaceTenantPath(I,n.tenantId)),!o.hasOwnProperty(c.Constants.clientInfo))throw this.logger.warning("ClientInfo not received in the response from AAD"),C.ClientAuthError.createClientInfoNotPopulatedError("ClientInfo not received in the response from the server");g=o[c.Constants.clientInfo],n.account=d.Account.createAccount(n.idToken,new a.ClientInfo(g));var S;S=n.account&&!h.Utils.isEmpty(n.account.homeAccountIdentifier)?n.account.homeAccountIdentifier:c.Constants.no_account,s=l.Storage.generateAcquireTokenAccountKey(S,t.state);var E=l.Storage.generateAcquireTokenAccountKey(c.Constants.no_account,t.state),b=this.cacheStorage.getItem(s),A=void 0;h.Utils.isEmpty(b)?h.Utils.isEmpty(this.cacheStorage.getItem(E))||(n=this.saveAccessToken(n,I,o,g)):(A=JSON.parse(b),n.account&&A&&h.Utils.compareAccounts(n.account,A)?(n=this.saveAccessToken(n,I,o,g),this.logger.info("The user object received in the response is the same as the one passed in the acquireToken request")):this.logger.warning("The account object created from the response is not the same as the one passed in the acquireToken request"))}o.hasOwnProperty(c.Constants.idToken)&&(this.logger.info("Fragment has id token"),this.loginInProgress=!1,n=h.Utils.setResponseIdToken(n,new u.IdToken(o[c.Constants.idToken])),o.hasOwnProperty(c.Constants.clientInfo)?g=o[c.Constants.clientInfo]:this.logger.warning("ClientInfo not received in the response from AAD"),i=l.Storage.generateAuthorityKey(t.state),I=this.cacheStorage.getItem(i,this.inCookie),h.Utils.isEmpty(I)||(I=h.Utils.replaceTenantPath(I,n.idToken.tenantId)),this.account=d.Account.createAccount(n.idToken,new a.ClientInfo(g)),n.account=this.account,n.idToken&&n.idToken.nonce?n.idToken.nonce!==this.cacheStorage.getItem(c.Constants.nonceIdToken,this.inCookie)?(this.account=null,this.cacheStorage.setItem(c.Constants.loginError,"Nonce Mismatch. Expected Nonce: "+this.cacheStorage.getItem(c.Constants.nonceIdToken,this.inCookie)+",Actual Nonce: "+n.idToken.nonce),this.logger.error("Nonce Mismatch.Expected Nonce: "+this.cacheStorage.getItem(c.Constants.nonceIdToken,this.inCookie)+",Actual Nonce: "+n.idToken.nonce),r=C.ClientAuthError.createNonceMismatchError(this.cacheStorage.getItem(c.Constants.nonceIdToken,this.inCookie),n.idToken.nonce)):(this.cacheStorage.setItem(c.Constants.idTokenKey,o[c.Constants.idToken]),this.cacheStorage.setItem(c.Constants.msalClientInfo,g),this.saveAccessToken(n,I,o,g)):(i=t.state,s=t.state,this.logger.error("Invalid id_token received in the response"),r=C.ClientAuthError.createInvalidIdTokenError(n.idToken),this.cacheStorage.setItem(c.Constants.msalError,r.errorCode),this.cacheStorage.setItem(c.Constants.msalErrorDescription,r.errorMessage)))}else{i=t.state,s=t.state;var k=this.cacheStorage.getItem(c.Constants.stateLogin,this.inCookie);this.logger.error("State Mismatch.Expected State: "+k+",Actual State: "+t.state),r=C.ClientAuthError.createInvalidStateError(t.state,k),this.cacheStorage.setItem(c.Constants.msalError,r.errorCode),this.cacheStorage.setItem(c.Constants.msalErrorDescription,r.errorMessage)}if(this.cacheStorage.setItem(c.Constants.renewStatus+t.state,c.Constants.tokenRenewStatusCompleted),this.cacheStorage.removeAcquireTokenEntries(),this.inCookie&&(this.cacheStorage.setItemCookie(i,"",-1),this.cacheStorage.clearCookie()),r)throw r;if(!n)throw m.AuthError.createUnexpectedError("Response is null");return n},e.prototype.getAccount=function(){if(this.account)return this.account;var e=this.cacheStorage.getItem(c.Constants.idTokenKey),t=this.cacheStorage.getItem(c.Constants.msalClientInfo);if(h.Utils.isEmpty(e)||h.Utils.isEmpty(t))return null;var r=new u.IdToken(e),n=new a.ClientInfo(t);return this.account=d.Account.createAccount(r,n),this.account},e.prototype.getAccountState=function(e){if(e){var t=e.indexOf("|");if(-1<t&&t+1<e.length)return e.substring(t+1)}return e},e.prototype.getAllAccounts=function(){for(var e=[],t=this.cacheStorage.getAllAccessTokens(c.Constants.clientId,c.Constants.homeAccountIdentifier),r=0;r<t.length;r++){var n=new u.IdToken(t[r].value.idToken),o=new a.ClientInfo(t[r].value.homeAccountIdentifier),i=d.Account.createAccount(n,o);e.push(i)}return this.getUniqueAccounts(e)},e.prototype.getUniqueAccounts=function(e){if(!e||e.length<=1)return e;for(var t=[],r=[],n=0;n<e.length;++n)e[n].homeAccountIdentifier&&-1===t.indexOf(e[n].homeAccountIdentifier)&&(t.push(e[n].homeAccountIdentifier),r.push(e[n]));return r},e.prototype.validateInputScope=function(e,t){if(e){if(!Array.isArray(e))throw y.ClientConfigurationError.createScopesNonArrayError(e);if(e.length<1)throw y.ClientConfigurationError.createEmptyScopesArrayError(e.toString());if(-1<e.indexOf(this.clientId)&&1<e.length)throw y.ClientConfigurationError.createClientIdSingleScopeError(e.toString())}else if(t)throw y.ClientConfigurationError.createScopesRequiredError(e)},e.prototype.getScopeFromState=function(e){if(e){var t=e.indexOf("|");if(-1<t&&t+1<e.length)return e.substring(t+1)}return""},e.prototype.appendScopes=function(e){var t;return e&&e.scopes&&(t=e.extraScopesToConsent?e.scopes.concat(e.extraScopesToConsent):e.scopes),t},e.prototype.broadcast=function(e,t){var r=new CustomEvent(e,{detail:t});window.dispatchEvent(r)},e.prototype.getCachedTokenInternal=function(e,t,r){var n=t||this.getAccount();if(!n)return null;var o=this.authorityInstance?this.authorityInstance:p.AuthorityFactory.CreateInstance(this.authority,this.config.auth.validateAuthority),i=this.getTokenType(n,e,!0),a=new s.ServerRequestParameters(o,this.clientId,e,i,this.getRedirectUri(),r);return this.getCachedToken(a,t)},e.prototype.getScopesForEndpoint=function(e){if(0<this.config.framework.unprotectedResources.length)for(var t=0;t<this.config.framework.unprotectedResources.length;t++)if(-1<e.indexOf(this.config.framework.unprotectedResources[t]))return null;if(0<this.config.framework.protectedResourceMap.size)for(var r=0,n=Array.from(this.config.framework.protectedResourceMap.keys());r<n.length;r++){var o=n[r];if(-1<e.indexOf(o))return this.config.framework.protectedResourceMap.get(o)}return-1<e.indexOf("http://")||-1<e.indexOf("https://")?this.getHostFromUri(e)===this.getHostFromUri(this.getRedirectUri())?new Array(this.clientId):null:new Array(this.clientId)},e.prototype.getLoginInProgress=function(){return!!this.cacheStorage.getItem(c.Constants.urlHash)||this.loginInProgress},e.prototype.setloginInProgress=function(e){this.loginInProgress=e},e.prototype.getAcquireTokenInProgress=function(){return this.acquireTokenInProgress},e.prototype.setAcquireTokenInProgress=function(e){this.acquireTokenInProgress=e},e.prototype.getLogger=function(){return this.config.system.logger},e.prototype.getRedirectUri=function(){return"function"==typeof this.config.auth.redirectUri?this.config.auth.redirectUri():this.config.auth.redirectUri},e.prototype.getPostLogoutRedirectUri=function(){return"function"==typeof this.config.auth.postLogoutRedirectUri?this.config.auth.postLogoutRedirectUri():this.config.auth.postLogoutRedirectUri},e.prototype.getCurrentConfiguration=function(){if(!this.config)throw y.ClientConfigurationError.createNoSetConfigurationError();return this.config},e.prototype.getHash=function(e){return-1<e.indexOf("#/")?e=e.substring(e.indexOf("#/")+2):-1<e.indexOf("#")&&(e=e.substring(1)),e},e.prototype.getHostFromUri=function(e){var t=String(e).replace(/^(https?:)\/\//,"");return t.split("/")[0]},e.prototype.getTokenType=function(e,t,r){return r?h.Utils.compareAccounts(e,this.getAccount())?-1<t.indexOf(this.config.auth.clientId)?S:E:-1<t.indexOf(this.config.auth.clientId)?S:b:h.Utils.compareAccounts(e,this.getAccount())?-1<t.indexOf(this.clientId)?S:E:b},e.prototype.setAccountCache=function(e,t){var r=e?this.getAccountId(e):c.Constants.no_account,n=l.Storage.generateAcquireTokenAccountKey(r,t);this.cacheStorage.setItem(n,JSON.stringify(e))},e.prototype.setAuthorityCache=function(e,t){var r=l.Storage.generateAuthorityKey(e);this.cacheStorage.setItem(r,h.Utils.CanonicalizeUri(t),this.inCookie)},e.prototype.updateCacheEntries=function(e,t,r){r?(this.cacheStorage.setItem(c.Constants.loginRequest,r,this.inCookie),this.cacheStorage.setItem(c.Constants.loginError,""),this.cacheStorage.setItem(c.Constants.stateLogin,e.state,this.inCookie),this.cacheStorage.setItem(c.Constants.nonceIdToken,e.nonce,this.inCookie),this.cacheStorage.setItem(c.Constants.msalError,""),this.cacheStorage.setItem(c.Constants.msalErrorDescription,"")):this.setAccountCache(t,e.state),this.setAuthorityCache(e.state,e.authority),this.cacheStorage.setItem(c.Constants.nonceIdToken,e.nonce,this.inCookie)},e.prototype.getAccountId=function(e){return h.Utils.isEmpty(e.homeAccountIdentifier)?c.Constants.no_account:e.homeAccountIdentifier},e.prototype.buildIDTokenRequest=function(e){return{scopes:[this.clientId],authority:this.authority,account:this.getAccount(),extraQueryParameters:e.extraQueryParameters}},e.prototype.populateQueryParams=function(e,t,r,n){var o,i={};return t&&(t.prompt&&(this.validatePromptParameter(t.prompt),r.promptValue=t.prompt),t.claimsRequest&&(g.validateClaimsRequest(t),r.claimsValue=t.claimsRequest),h.Utils.isSSOParam(t)&&(i=h.Utils.constructUnifiedCacheQueryParameter(t,null))),n&&(i=h.Utils.constructUnifiedCacheQueryParameter(null,n)),this.logger.verbose("Calling addHint parameters"),i=this.addHintParameters(e,i,r),t&&(o=this.sanitizeEQParams(t)),r.queryParameters=h.Utils.generateQueryParametersString(i),r.extraQueryParameters=h.Utils.generateQueryParametersString(o),r},e.prototype.validatePromptParameter=function(e){if(!(0<=[c.PromptState.LOGIN,c.PromptState.SELECT_ACCOUNT,c.PromptState.CONSENT,c.PromptState.NONE].indexOf(e)))throw y.ClientConfigurationError.createInvalidPromptError(e)},e.prototype.sanitizeEQParams=function(e){var t=e.extraQueryParameters;return t?(e.claimsRequest&&(this.logger.warning("Removed duplicate claims from extraQueryParameters. Please use either the claimsRequest field OR pass as extraQueryParameter - not both."),delete t[c.Constants.claims]),delete t[c.SSOTypes.SID],delete t[c.SSOTypes.LOGIN_HINT],t):null},n.__decorate([A],e.prototype,"acquireTokenSilent",null),e}();t.UserAgentApplication=k},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=function(){function e(e,t,r,n,o,i,s){this.accountIdentifier=e,this.homeAccountIdentifier=t,this.userName=r,this.name=n,this.idToken=o,this.sid=i,this.environment=s}return e.createAccount=function(t,r){var o,i=t.objectId||t.subject,s=r?r.uid:"",a=r?r.utid:"";return n.Utils.isEmpty(s)||n.Utils.isEmpty(a)||(o=n.Utils.base64EncodeStringUrlSafe(s)+"."+n.Utils.base64EncodeStringUrlSafe(a)),new e(i,o,t.preferredName,t.name,t.decodedIdToken,t.sid,t.issuer)},e}();t.Account=o},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(6),i=r(12),s=function(e){function t(t,r){return e.call(this,t,r)||this}return n.__extends(t,e),Object.defineProperty(t.prototype,"AadInstanceDiscoveryEndpointUrl",{get:function(){return t.AadInstanceDiscoveryEndpoint+"?api-version=1.0&authorization_endpoint="+this.CanonicalAuthority+"oauth2/v2.0/authorize"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"AuthorityType",{get:function(){return o.AuthorityType.Aad},enumerable:!0,configurable:!0}),t.prototype.GetOpenIdConfigurationEndpointAsync=function(){var e=this,t=new Promise((function(t,r){return t(e.DefaultOpenIdConfigurationEndpoint)}));if(!this.IsValidationEnabled)return t;var r=this.CanonicalAuthorityUrlComponents.HostNameAndPort;return this.IsInTrustedHostList(r)?t:(new i.XhrClient).sendRequestAsync(this.AadInstanceDiscoveryEndpointUrl,"GET",!0).then((function(e){return e.tenant_discovery_endpoint}))},t.prototype.IsInTrustedHostList=function(e){return t.TrustedHostList[e.toLowerCase()]},t.AadInstanceDiscoveryEndpoint="https://login.microsoftonline.com/common/discovery/instance",t.TrustedHostList={"login.windows.net":"login.windows.net","login.chinacloudapi.cn":"login.chinacloudapi.cn","login.cloudgovapi.us":"login.cloudgovapi.us","login.microsoftonline.com":"login.microsoftonline.com","login.microsoftonline.de":"login.microsoftonline.de","login.microsoftonline.us":"login.microsoftonline.us"},t}(o.Authority);t.AadAuthority=s},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.sendRequestAsync=function(e,t,r){var n=this;return new Promise((function(r,o){var i=new XMLHttpRequest;if(i.open(t,e,!0),i.onload=function(e){(i.status<200||300<=i.status)&&o(n.handleError(i.responseText));try{var t=JSON.parse(i.responseText)}catch(e){o(n.handleError(i.responseText))}r(t)},i.onerror=function(e){o(i.status)},"GET"!==t)throw"not implemented";i.send()}))},e.prototype.handleError=function(e){var t;try{if((t=JSON.parse(e)).error)return t.error;throw e}catch(t){return e}},e}();t.XhrClient=n},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(7),i=r(0),s={clientId:"",authority:null,validateAuthority:!0,redirectUri:function(){return i.Utils.getDefaultRedirectUri()},postLogoutRedirectUri:function(){return i.Utils.getDefaultRedirectUri()},navigateToLoginRequestUrl:!0},a={cacheLocation:"sessionStorage",storeAuthStateInCookie:!1},c={logger:new o.Logger(null),loadFrameTimeout:6e3,tokenRenewalOffsetSeconds:300,navigateFrameWait:500},u={isAngular:!1,unprotectedResources:new Array,protectedResourceMap:new Map};t.buildConfiguration=function(e){var t=e.auth,r=e.cache,o=void 0===r?{}:r,i=e.system,l=void 0===i?{}:i,d=e.framework,h=void 0===d?{}:d;return{auth:n.__assign({},s,t),cache:n.__assign({},a,o),system:n.__assign({},c,l),framework:n.__assign({},u,h)}}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(3);t.validateClaimsRequest=function(e){if(e.claimsRequest)try{JSON.parse(e.claimsRequest)}catch(e){throw n.ClientConfigurationError.createClaimsRequestParsingError(e)}}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(8);t.InteractionRequiredAuthErrorMessage={loginRequired:{code:"login_required"},interactionRequired:{code:"interaction_required"},consentRequired:{code:"consent_required"}};var i=function(e){function r(t,n){var o=e.call(this,t,n)||this;return o.name="InteractionRequiredAuthError",Object.setPrototypeOf(o,r.prototype),o}return n.__extends(r,e),r.createLoginRequiredAuthError=function(e){return new r(t.InteractionRequiredAuthErrorMessage.loginRequired.code,e)},r.createInteractionRequiredAuthError=function(e){return new r(t.InteractionRequiredAuthErrorMessage.interactionRequired.code,e)},r.createConsentRequiredAuthError=function(e){return new r(t.InteractionRequiredAuthErrorMessage.consentRequired.code,e)},r}(o.ServerError);t.InteractionRequiredAuthError=i},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.buildResponseStateOnly=function(e){return{uniqueId:"",tenantId:"",tokenType:"",idToken:null,accessToken:"",scopes:null,expiresOn:null,account:null,accountState:e}}},function(e,t,r){e.exports=r(18)},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(9);t.UserAgentApplication=n.UserAgentApplication;var o=r(7);t.Logger=o.Logger;var i=r(7);t.LogLevel=i.LogLevel;var s=r(10);t.Account=s.Account;var a=r(2);t.Constants=a.Constants;var c=r(6);t.Authority=c.Authority;var u=r(9);t.CacheResult=u.CacheResult;var l=r(13);t.CacheLocation=l.CacheLocation,t.Configuration=l.Configuration;var d=r(14);t.AuthenticationParameters=d.AuthenticationParameters;var h=r(16);t.AuthResponse=h.AuthResponse;var p=r(5);t.AuthError=p.AuthError;var f=r(4);t.ClientAuthError=f.ClientAuthError;var g=r(8);t.ServerError=g.ServerError;var y=r(3);t.ClientConfigurationError=y.ClientConfigurationError;var m=r(15);t.InteractionRequiredAuthError=m.InteractionRequiredAuthError},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0);t.AccessTokenKey=function(e,t,r,o,i){this.authority=n.Utils.CanonicalizeUri(e),this.clientId=t,this.scopes=r,this.homeAccountIdentifier=n.Utils.base64EncodeStringUrlSafe(o)+"."+n.Utils.base64EncodeStringUrlSafe(i)}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});t.AccessTokenValue=function(e,t,r,n){this.accessToken=e,this.idToken=t,this.expiresIn=r,this.homeAccountIdentifier=n}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=function(){function e(e,t,r,o,i,s){this.authorityInstance=e,this.clientId=t,this.scopes=r,this.nonce=n.Utils.createNewGuid(),this.state=s&&!n.Utils.isEmpty(s)?n.Utils.createNewGuid()+"|"+s:n.Utils.createNewGuid(),this.correlationId=n.Utils.createNewGuid(),this.xClientSku="MSAL.JS",this.xClientVer=n.Utils.getLibraryVersion(),this.responseType=o,this.redirectUri=i}return Object.defineProperty(e.prototype,"authority",{get:function(){return this.authorityInstance?this.authorityInstance.CanonicalAuthority:null},enumerable:!0,configurable:!0}),e.prototype.createNavigateUrl=function(e){var t=this.createNavigationUrlString(e),r=this.authorityInstance.AuthorizationEndpoint;return r.indexOf("?")<0?r+="?":r+="&",""+r+t.join("&")},e.prototype.createNavigationUrlString=function(e){e||(e=[this.clientId]),-1===e.indexOf(this.clientId)&&e.push(this.clientId);var t=[];return t.push("response_type="+this.responseType),this.translateclientIdUsedInScope(e),t.push("scope="+encodeURIComponent(this.parseScope(e))),t.push("client_id="+encodeURIComponent(this.clientId)),t.push("redirect_uri="+encodeURIComponent(this.redirectUri)),t.push("state="+encodeURIComponent(this.state)),t.push("nonce="+encodeURIComponent(this.nonce)),t.push("client_info=1"),t.push("x-client-SKU="+this.xClientSku),t.push("x-client-Ver="+this.xClientVer),this.promptValue&&t.push("prompt="+encodeURIComponent(this.promptValue)),this.claimsValue&&t.push("claims="+encodeURIComponent(this.claimsValue)),this.queryParameters&&t.push(this.queryParameters),this.extraQueryParameters&&t.push(this.extraQueryParameters),t.push("client-request-id="+encodeURIComponent(this.correlationId)),t},e.prototype.translateclientIdUsedInScope=function(e){var t=e.indexOf(this.clientId);0<=t&&(e.splice(t,1),-1===e.indexOf("openid")&&e.push("openid"),-1===e.indexOf("profile")&&e.push("profile"))},e.prototype.parseScope=function(e){var t="";if(e)for(var r=0;r<e.length;++r)t+=r!==e.length-1?e[r]+" ":e[r];return t},e}();t.ServerRequestParameters=o},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(4),i=function(){function e(e){if(!e||n.Utils.isEmpty(e))return this.uid="",void(this.utid="");try{var t=n.Utils.base64DecodeStringUrlSafe(e),r=JSON.parse(t);r&&(r.hasOwnProperty("uid")&&(this.uid=r.uid),r.hasOwnProperty("utid")&&(this.utid=r.utid))}catch(e){throw o.ClientAuthError.createClientInfoDecodingError(e)}}return Object.defineProperty(e.prototype,"uid",{get:function(){return this._uid?this._uid:""},set:function(e){this._uid=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"utid",{get:function(){return this._utid?this._utid:""},set:function(e){this._utid=e},enumerable:!0,configurable:!0}),e}();t.ClientInfo=i},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(4);t.IdToken=function(e){if(n.Utils.isEmpty(e))throw o.ClientAuthError.createIdTokenNullOrEmptyError(e);try{this.rawIdToken=e,this.decodedIdToken=n.Utils.extractIdToken(e),this.decodedIdToken&&(this.decodedIdToken.hasOwnProperty("iss")&&(this.issuer=this.decodedIdToken.iss),this.decodedIdToken.hasOwnProperty("oid")&&(this.objectId=this.decodedIdToken.oid),this.decodedIdToken.hasOwnProperty("sub")&&(this.subject=this.decodedIdToken.sub),this.decodedIdToken.hasOwnProperty("tid")&&(this.tenantId=this.decodedIdToken.tid),this.decodedIdToken.hasOwnProperty("ver")&&(this.version=this.decodedIdToken.ver),this.decodedIdToken.hasOwnProperty("preferred_username")&&(this.preferredName=this.decodedIdToken.preferred_username),this.decodedIdToken.hasOwnProperty("name")&&(this.name=this.decodedIdToken.name),this.decodedIdToken.hasOwnProperty("nonce")&&(this.nonce=this.decodedIdToken.nonce),this.decodedIdToken.hasOwnProperty("exp")&&(this.expiration=this.decodedIdToken.exp),this.decodedIdToken.hasOwnProperty("home_oid")&&(this.homeObjectId=this.decodedIdToken.home_oid),this.decodedIdToken.hasOwnProperty("sid")&&(this.sid=this.decodedIdToken.sid))}catch(e){throw o.ClientAuthError.createIdTokenParsingError(e)}}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),o=r(25),i=r(2),s=r(3),a=function(){function e(t){if(e.instance)return e.instance;if(this.cacheLocation=t,this.localStorageSupported=void 0!==window[this.cacheLocation]&&null!=window[this.cacheLocation],this.sessionStorageSupported=void 0!==window[t]&&null!=window[t],!(e.instance=this).localStorageSupported&&!this.sessionStorageSupported)throw s.ClientConfigurationError.createNoStorageSupportedError();return e.instance}return e.prototype.setItem=function(e,t,r){window[this.cacheLocation]&&window[this.cacheLocation].setItem(e,t),r&&this.setItemCookie(e,t)},e.prototype.getItem=function(e,t){return t&&this.getItemCookie(e)?this.getItemCookie(e):window[this.cacheLocation]?window[this.cacheLocation].getItem(e):null},e.prototype.removeItem=function(e){if(window[this.cacheLocation])return window[this.cacheLocation].removeItem(e)},e.prototype.clear=function(){if(window[this.cacheLocation])return window[this.cacheLocation].clear()},e.prototype.getAllAccessTokens=function(e,t){var r,n=[],i=window[this.cacheLocation];if(i){var s=void 0;for(s in i)if(i.hasOwnProperty(s)&&s.match(e)&&s.match(t)){var a=this.getItem(s);a&&(r=new o.AccessTokenCacheItem(JSON.parse(s),JSON.parse(a)),n.push(r))}}return n},e.prototype.removeAcquireTokenEntries=function(){var e=window[this.cacheLocation];if(e){var t=void 0;for(t in e)if(e.hasOwnProperty(t)&&(-1!==t.indexOf(i.CacheKeys.AUTHORITY)||1!==t.indexOf(i.CacheKeys.ACQUIRE_TOKEN_ACCOUNT))){var r=t.split(n.Constants.resourceDelimiter),o=void 0;1<r.length&&(o=r[1]),o&&!this.tokenRenewalInProgress(o)&&(this.removeItem(t),this.removeItem(n.Constants.renewStatus+o),this.removeItem(n.Constants.stateLogin),this.removeItem(n.Constants.stateAcquireToken),this.setItemCookie(t,"",-1))}}this.clearCookie()},e.prototype.tokenRenewalInProgress=function(e){var t=window[this.cacheLocation][n.Constants.renewStatus+e];return!(!t||t!==n.Constants.tokenRenewStatusInProgress)},e.prototype.resetCacheItems=function(){var e=window[this.cacheLocation];if(e){var t=void 0;for(t in e)e.hasOwnProperty(t)&&-1!==t.indexOf(n.Constants.msal)&&this.setItem(t,"");this.removeAcquireTokenEntries()}},e.prototype.setItemCookie=function(e,t,r){var n=e+"="+t+";";r&&(n+="expires="+this.getCookieExpirationTime(r)+";"),document.cookie=n},e.prototype.getItemCookie=function(e){for(var t=e+"=",r=document.cookie.split(";"),n=0;n<r.length;n++){for(var o=r[n];" "===o.charAt(0);)o=o.substring(1);if(0===o.indexOf(t))return o.substring(t.length,o.length)}return""},e.prototype.getCookieExpirationTime=function(e){var t=new Date;return new Date(t.getTime()+24*e*60*60*1e3).toUTCString()},e.prototype.clearCookie=function(){this.setItemCookie(n.Constants.nonceIdToken,"",-1),this.setItemCookie(n.Constants.stateLogin,"",-1),this.setItemCookie(n.Constants.loginRequest,"",-1),this.setItemCookie(n.Constants.stateAcquireToken,"",-1)},e.generateAcquireTokenAccountKey=function(e,t){return i.CacheKeys.ACQUIRE_TOKEN_ACCOUNT+n.Constants.resourceDelimiter+""+e+n.Constants.resourceDelimiter+t},e.generateAuthorityKey=function(e){return i.CacheKeys.AUTHORITY+n.Constants.resourceDelimiter+""+e},e}();t.Storage=a},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});t.AccessTokenCacheItem=function(e,t){this.key=e,this.value=t}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(11),i=r(27),s=r(6),a=r(3),c=function(){function e(){}return e.DetectAuthorityFromUrl=function(e){switch(e=n.Utils.CanonicalizeUri(e),n.Utils.GetUrlComponents(e).PathSegments[0]){case"tfp":return s.AuthorityType.B2C;case"adfs":return s.AuthorityType.Adfs;default:return s.AuthorityType.Aad}},e.CreateInstance=function(t,r){if(n.Utils.isEmpty(t))return null;switch(e.DetectAuthorityFromUrl(t)){case s.AuthorityType.B2C:return new i.B2cAuthority(t,r);case s.AuthorityType.Aad:return new o.AadAuthority(t,r);default:throw a.ClientConfigurationErrorMessage.invalidAuthorityType}},e}();t.AuthorityFactory=c},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(11),i=r(6),s=r(3),a=r(0),c=function(e){function t(t,r){var n=e.call(this,t,r)||this,o=a.Utils.GetUrlComponents(t),i=o.PathSegments;if(i.length<3)throw s.ClientConfigurationErrorMessage.b2cAuthorityUriInvalidPath;return n.CanonicalAuthority="https://"+o.HostNameAndPort+"/"+i[0]+"/"+i[1]+"/"+i[2]+"/",n}return n.__extends(t,e),Object.defineProperty(t.prototype,"AuthorityType",{get:function(){return i.AuthorityType.B2C},enumerable:!0,configurable:!0}),t.prototype.GetOpenIdConfigurationEndpointAsync=function(){var e=this,t=new Promise((function(t,r){return t(e.DefaultOpenIdConfigurationEndpoint)}));return this.IsValidationEnabled?this.IsInTrustedHostList(this.CanonicalAuthorityUrlComponents.HostNameAndPort)?t:new Promise((function(e,t){return t(s.ClientConfigurationErrorMessage.unsupportedAuthorityValidation)})):t},t}(o.AadAuthority);t.B2cAuthority=c}])}));